---
description:
globs:
alwaysApply: false
---
# 数据管理规范

## 2.1 数据导入

### CSV文件处理规范

#### 多行文本字段处理规则

当CSV文件包含多行文本字段时，需要特别注意以下问题和解决方案：

1. 问题表征：
   - CSV文件在Excel和Numbers等不同软件中显示行数不一致
   - pandas读取时将单个记录错误拆分为多行
   - 字段内换行符导致数据解析错误

2. 原理分析：
   - CSV规范中，字段内换行需要用引号包裹
   - 不同软件对引号和换行符的处理逻辑不同
   - pandas默认配置可能无法正确处理复杂的引号嵌套

3. 解决方案：
   a. 预处理方法：
      - 使用引号计数识别完整数据行
      - 智能处理字段分割，保护引号内的逗号
      - 清理不必要的换行符和空白字符
      - 保持必要的引号结构

   b. 处理步骤：
      - 分离标题行和数据内容
      - 基于引号配对合并分散的数据行
      - 规范化字段引号和分隔符
      - 生成清理后的CSV文件

4. 验证标准：
   - 数据行数应与实际记录数一致
   - 字段内容完整，无不当换行
   - pandas可正确读取处理后的文件
